generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Level {
  id                   String               @id @default(uuid())
  name                 String
  slug                 String               @unique
  users                User[]
  leasons              Leasons[]
  createdAt            DateTime             @default(now())
  updatedAt            DateTime             @updatedAt
  userLeasonProgresses UserLeasonProgress[]
}

model User {
  id                      String    @id @default(uuid())
  firstName               String
  lastName                String
  email                   String    @unique
  password                String
  levelId                 String?
  level                   Level?    @relation(fields: [levelId], references: [id])
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt
  userLeasonProgresses    UserLeasonProgress[]
  isVerified              Boolean   @default(false)
  verificationCode        String?
  verificationCodeExpiry  DateTime?
}

model Leasons {
  id                   String               @id @default(uuid())
  slug                 String               @unique
  title                String
  description          String
  explanation          String
  exampleCommand       String
  hint                 String
  objective            String
  levelId              String
  level                Level                @relation(fields: [levelId], references: [id])
  isPaid               Boolean              @default(false)
  order                Int                  @default(0)
  completionPattern    String?
  createdAt            DateTime             @default(now())
  updatedAt            DateTime             @updatedAt
  userLeasonProgresses UserLeasonProgress[]
}

model UserLeasonProgress {
  id          String   @id @default(uuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id])
  leasonId    String
  leason      Leasons  @relation(fields: [leasonId], references: [id])
  levelId     String
  level       Level    @relation(fields: [levelId], references: [id])
  completedAt DateTime @default(now())
  isCompleted Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([userId, leasonId])
}

model GitCommandCategory {
  id          String       @id @default(uuid())
  name        String       @unique
  label       String
  icon        String
  commands    GitCommand[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

model GitCommand {
  id          String             @id @default(uuid())
  name        String             @unique
  syntax      String
  description String
  whenToUse   String
  example     String
  categoryId  String
  category    GitCommandCategory @relation(fields: [categoryId], references: [id])
  isCommon    Boolean            @default(false)
  createdAt   DateTime           @default(now())
  updatedAt   DateTime           @updatedAt
}

model Tip {
  id          String   @id @default(uuid())
  type        TipType
  title       String
  description String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

enum TipType {
  warning
  pro
  do
  dont
}
